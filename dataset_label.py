import pandas as pd

# Load monitored data
data = pd.read_csv("normal_annomaly_dataset.csv")

# Define anomaly injection periods (start and end timestamps)
anomaly_periods = [
("1737373204592","1737373207760"),
("1737373208623","1737373211639"),
("1737373219631","1737373222654"),
("1737373221634","1737373224641"),
("1737373229645","1737373232666"),
("1737373206596","1737373209618"),
("1737204060078","1737204063083"),
("1737204064086","1737204067089"),
("1737204051064","1737204054107"),
("1737204062082","1737204065100"),
("1737204073107","1737204076130"),
("1737204077137","1737204080166"),
("1737204048046","1737204051074"),
("1737204075114","1737204078125"),
("1737205518224","1737205521228"),
("1737205520226","1737205523311"),
("1737205526257","1737205529279"),
("1737205546382","1737205549470"),
("1737205530265","1737205533287"),
("1737205533272","1737205536414"),
("1737205540299","1737205543446"),
("1737205522231","1737205525259"),
("1737385846738","1737385849741"),
("1737385816246","1737385819308"),
("1737385834689","1737385837865"),
("1737385824277","1737385827311"),
("1737385829298","1737385832368"),
("1737385827282","1737385830292"),
("1737385840714","1737385843735"),
("1737385819254","1737385822277"),
("1737385832672","1737385835694"),
("1737385836691","1737385839715"),
("1737385504700","1737385507703"),
("1737385509709","1737385512738"),
("1737385489457","1737385492527"),
("1737385497493","1737385500497"),
("1737385486437","1737385489479"),
("1737385495479","1737385498516"),
("1737385511712","1737385514735"),
("1737385367314","1737385370316"),
("1737385374322","1737385377425"),
("1737385344233","1737385347263"),
("1737385364310","1737385367323"),
("1737385360272","1737385363303"),
("1737385346237","1737385349260"),
("1737385362284","1737385365306"),
("1737204993704","1737204996710"),
("1737205005087","1737205008096"),
("1737205011765","1737205014768"),
("1737204988694","1737204991705"),
("1737204995705","1737204998726"),
("1737204997710","1737205000825"),
("1737205001724","1737205004743"),
("1737205007745","1737205010804"),
("1737205014772","1737205017819"),
("1737385717220","1737385720223"),
("1737385739693","1737385742696"),
("1737385737540","1737385740693"),
("1737385713213","1737385716223"),
("1737385728232","1737385731238"),
("1737385732240","1737385735252"),
("1737385735512","1737385738533"),
("1737385743697","1737385746747"),
("1737385885004","1737385888012"),
("1737385889028","1737385892037"),
("1737385902071","1737385905074"),
("1737385883001","1737385886018"),
("1737385897053","1737385900105"),
("1737385909084","1737385912104"),
("1737385881000","1737385884019"),
("1737385905079","1737385908084"),
("1737385900058","1737385903083"),
("1737385887008","1737385890034"),
("1737385891033","1737385894056"),
("1737385756924","1737385759926"),
("1737385781026","1737385784029"),
("1737385763950","1737385767064"),
("1737385769975","1737385773040"),
("1737385760930","1737385763956"),
("1737385766950","1737385770022"),
("1737385773978","1737385777001"),
("1737385778998","1737385782021"),
("1737386090834","1737386093837"),
("1737386085829","1737386088952"),
("1737386098024","1737386101167"),
("1737386068758","1737386071780"),
("1737386074783","1737386077848"),
("1737386088832","1737386091853"),
("1737386092837","1737386095929"),
("1737386071764","1737386074932"),
("1737386083818","1737386086863"),
("1737386100046","1737386103050"),
("1737386081795","1737386084835"),
("1737386094842","1737386099724"),
("1737385929454","1737385932468"),
("1737385937472","1737385940635"),
("1737385958832","1737385961855"),
("1737385933463","1737385936471"),
("1737385945795","1737385948801"),
("1737385960836","1737385963844"),
("1737385942497","1737385945502"),
("1737385948805","1737385951844"),
("1737385939476","1737385942658"),
("1737203870411","1737203873414"),
("1737203875419","1737203878422"),
("1737203883431","1737203886461"),
("1737203893464","1737203896489"),
("1737203879422","1737203882442"),
("1737203891451","1737203894466"),
("1737203895462","1737203898581"),
("1737203867142","1737203870162"),
("1737203887437","1737203890498"),
("1737203897466","1737203900489"),
("1737202692861","1737202695869"),
("1737202678827","1737202681841"),
("1737202685834","1737202688850"),
("1737202705102","1737202708127"),
("1737202699095","1737202702106"),
("1737202689841","1737202692866"),
("1737202694865","1737202697870"),
("1737202674807","1737202677830"),
("1737385671025","1737385674030"),
("1737385677051","1737385680057"),
("1737385687305","1737385690352"),
("1737385669006","1737385672034"),
("1737385674030","1737385677158"),
("1737385692326","1737385695349"),
("1737385532463","1737385535466"),
("1737385553552","1737385556555"),
("1737385541472","1737385544499"),
("1737385546479","1737385549514"),
("1737385558549","1737385561585"),
("1737385549486","1737385552632"),
("1737385551506","1737385554528"),
("1737204762329","1737204765332"),
("1737204744270","1737204747299"),
("1737204749295","1737204752338"),
("1737204757320","1737204760361"),
("1737204771390","1737204774480"),
("1737204742268","1737204745280"),
("1737204747281","1737204750374"),
("1737204765338","1737204768708"),
("1737204768363","1737204771406"),
("1737202447906","1737202450909"),
("1737202455940","1737202458941"),
("1737202433862","1737202436879"),
("1737202453935","1737202457068"),
("1737202431860","1737202434868"),
("1737202444900","1737202447908"),
("1737202449909","1737202452930"),
("1737202427825","1737202431199"),
("1737202438868","1737202441910"),
("1737202451912","1737202454939"),
("1737202425812","1737202428842"),
("1737202429832","1737202432859"),
("1737371407464","1737371410467"),
("1737371414477","1737371417479"),
("1737371420491","1737371423496"),
("1737371401443","1737371404494"),
("1737371412467","1737371415484"),
("1737371418482","1737371421505"),
("1737371395145","1737371398156"),
("1737371398414","1737371401466"),
("1737371391131","1737371394155"),
("1737371403438","1737371406462"),
("1737371842397","1737371845399"),
("1737371850439","1737371853573"),
("1737371863492","1737371866691"),
("1737371853453","1737371856490"),
("1737371858479","1737371861505"),
("1737371848425","1737371851690"),
("1737371861481","1737371864523"),
("1737371865501","1737371869632"),
("1737371845404","1737371848527"),
("1737371855455","1737371858484"),
("1737371867526","1737371871051"),
("1737385444977","1737385447981"),
("1737385449985","1737385453038"),
("1737385460022","1737385463042"),
("1737385464031","1737385467049"),
("1737385446982","1737385450006"),
("1737385451989","1737385455001"),
("1737385457014","1737385460074"),
("1737385470038","1737385473065"),
("1737385441743","1737385444746"),
("1737385454996","1737385458044"),
("1737385472041","1737385475064"),
("1737370884676","1737370887679"),
("1737370890683","1737370893688"),
("1737370902735","1737370905738"),
("1737370913776","1737370916780"),
("1737370892684","1737370895709"),
("1737370898733","1737370901743"),
("1737370908743","1737370911755"),
("1737370896706","1737370899729"),
("1737370911750","1737370914775"),
("1737370915775","1737370918797"),
("1737203245400","1737203248403"),
("1737203250421","1737203253456"),
("1737203258756","1737203261765"),
("1737203266870","1737203269874"),
("1737203270888","1737203273891"),
("1737203255456","1737203258457"),
("1737203263847","1737203266940"),
("1737203248405","1737203251428"),
("1737203252427","1737203255471"),
("1737203261766","1737203264853"),
("1737385616086","1737385619107"),
("1737385619089","1737385622105"),
("1737385623107","1737385626160"),
("1737385637159","1737385640191"),
("1737385621093","1737385624162"),
("1737385640163","1737385643260"),
("1737385626118","1737385629141"),
("1737385630137","1737385633160"),
("1737385643188","1737385646211"),
("1737386055043","1737386058046"),
("1737386027936","1737386030959"),
("1737386030941","1737386033947"),
("1737386045019","1737386048074"),
("1737386050013","1737386053030"),
("1737386037948","1737386040998"),
("1737386041976","1737386045323"),
("1737386052015","1737386055074"),
("1737385402302","1737385405305"),
("1737385416563","1737385419571"),
("1737385400299","1737385403313"),
("1737385409314","1737385412395"),
("1737385404304","1737385407315"),
("1737385422588","1737385425621"),
("1737385412318","1737385415331"),
("1737385428615","1737385431813"),
("1737385418566","1737385421590"),
("1737385424593","1737385427616"),
("1737204451833","1737204454841"),
("1737204460053","1737204463056"),
("1737204463057","1737204466061"),
("1737204466071","1737204469074"),
("1737204476147","1737204479150"),
("1737204458043","1737204461083"),
("1737204479150","1737204482182"),
("1737204483157","1737204486168"),
("1737204454833","1737204457846"),
("1737204473080","1737204476125"),
("1737385586904","1737385589908"),
("1737385595939","1737385598944"),
("1737385602947","1737385605950"),
("1737385588910","1737385591994"),
("1737385598942","1737385601967"),
("1737385584901","1737385587915"),
("1737385592933","1737385595942"),
("1737385576638","1737385579656"),
("1737385581887","1737385584923"),
("1737385570613","1737385573636"),
("1737385590914","1737385593938"),
("1737205277992","1737205280995"),
("1737205297017","1737205300025"),
("1737205274991","1737205278011"),
("1737205288004","1737205291010"),
("1737205299021","1737205302044"),
("1737202896318","1737202899323"),
("1737202906365","1737202909370"),
("1737202911388","1737202914397"),
("1737202894561","1737202897575"),
("1737202898322","1737202901382"),
("1737202903357","1737202906564"),
("1737202909375","1737202912449"),
("1737202917407","1737202920481"),
("1737202915398","1737202918439"),
("1737202919430","1737202922547"),
("1737202891285","1737202894317"),
("1737202900329","1737202903543"),
("1737202921433","1737202924464"),
("1737372640949","1737372643951"),
("1737372643955","1737372646960"),
("1737372650973","1737372653985"),
("1737372629702","1737372632758"),
("1737372648961","1737372651972"),
("1737372625685","1737372628788"),
("1737372631703","1737372634704"),
("1737372654989","1737372658008"),
("1737372634926","1737372637950"),
("1737372652972","1737372656075"),
("1737373148050","1737373151064"),
("1737373159088","1737373162105"),
("1737373166096","1737373169202"),
("1737373170119","1737373173195"),
("1737373172124","1737373175130"),
("1737373157065","1737373160088"),
("1737373168100","1737373171123"),
("1737373174141","1737373177165"),
("1737204224682","1737204227685"),
("1737204230693","1737204233699"),
("1737204212577","1737204215593"),
("1737204221602","1737204224659"),
("1737204235713","1737204238753"),
("1737204232696","1737204235739"),
("1737204243719","1737204246731"),
("1737204219586","1737204222592"),
("1737203598005","1737203601008"),
("1737203608028","1737203611032"),
("1737203619221","1737203622256"),
("1737203623232","1737203626255"),
("1737203605023","1737203608065"),
("1737203596002","1737203599029"),
("1737203610033","1737203613174"),
("1737203614143","1737203618575"),
("1737203621199","1737203624245"),
("1737203625220","1737203628349"),
("1737203612042","1737203615120"),
("1737203617159","1737203620184"),
("1737385983151","1737385986153"),
("1737386007202","1737386010205"),
("1737386000189","1737386003213"),
("1737385990158","1737385993167"),
("1737385994165","1737385997174"),
("1737386002193","1737386005203"),
("1737385977133","1737385980157"),
("1737385997168","1737386000197")
]

# Add an 'anomaly' column initialized to 'Normal'
data["label"] = "Normal"

# Convert timestamps to pandas datetime for comparison
data["time"] = pd.to_numeric(data["time"])

# Mark rows as 'Anomaly' for the specified periods
for start, end in anomaly_periods:
    start_time = pd.to_numeric(start)
    end_time = pd.to_numeric(end)
    data.loc[(data["time"] >= start_time) & (data["time"] <= end_time), "label"] = "Anomaly"

# Save the labeled dataset
data.to_csv("labeled_dataset.csv", index=False)
